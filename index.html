<!DOCTYPE html>
<html>
  <head>

    <meta charset="utf-8">
    <title></title>
    <script src="https://pixijs.download/v4.5.3/pixi.min.js"></script>
    <!--<script src="pixi.min.js"></script>-->

  </head>
  <body>

    <script>

      // Pintamos el canvas
      var render = new PIXI.Application(900, 500);
      document.body.appendChild(render.view);
      var stage = new PIXI.Container();

      // Pintamos la imagen de fondo
      var texture = PIXI.Texture.fromImage('img/fondo.jpg');
      var tilingSprite = new PIXI.extras.TilingSprite(
          texture,
          render.screen.width=900,
          render.screen.height=500
      );
      render.stage.addChild(tilingSprite);

      // Inicializamos
      var basicText;
      var i = 0;
      var tPAUSA = 80;
      var tecla = null;
      var PAUSA = false;
      var malo = { width: 200, height: 200, x: 0, y: 0 };
      var boom = { width: 200, height: 200, x: 0, y: 0 };

      PIXI.loader
          .add("img/bs.png")
          .add('img/fondo.jpg')
          .add('img/boom1.jpg')
          .load(setup);

      function setup(){

        document.addEventListener('keydown', function(evento){
    				tecla = evento.keyCode;
            if (tecla == tPAUSA) { PAUSA = true; }
    		});

        if (PAUSA){
  				contexto.fillStyle = "white";
  				contexto.textAlign='center';
  				contexto.font="34px Arial";
  				contexto.fillText('PAUSA',width/2,height/2);
          PAUSA = false;
  			}else{
          maloCreate();
        }

      }

      function maloCreate(){
        var malo = PIXI.Sprite.fromImage('img/bs.png');

        // Posicionamos el elemento
        malo.x = render.screen.width + malo.width;
        malo.y = render.screen.height - malo.height;

        // Lo a√±adimos al canvas
        tilingSprite.addChild(malo);

        // Funcion en bucle
        render.ticker.add(function() {

            // Velocidad movimiento del elemeto
            tilingSprite.tilePosition.x -= 2;
            malo.x -= 2;

            /*if (malo.x < -900) {
              malo.x = app.screen.width + 200;
              app.stage.removeChild(enemgo.view); }*/

            if (malo.x < 200) {
              boom.x = malo.x; boom.y = malo.y;
              tilingSprite.removeChild(malo);
              explosionCreate();
              //render.stop();
            }
        });
      }

      function explosionCreate(){
        var boom = PIXI.Sprite.fromImage('img/boom1.png');
        tilingSprite.addChild(boom);
      }

      function timer() {
          tilingSprite.removeChild(basicText);
          i = i + 1;
          basicText = new PIXI.Text(i);
          tilingSprite.addChild(basicText);
          setTimeout("timer()",1000);
      }
      timer();

    </script>

  </body>
</html>
